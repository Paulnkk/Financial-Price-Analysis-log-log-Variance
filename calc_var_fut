import pandas as pd 
import numpy as np
import statistics 
import math 

es = pd.read_csv('ES.csv')
ft = pd.read_csv('FT.csv')

#calc variance over 10000 time shifts for ~ 3 Mio prices
sd_list = []
close_list = es['Close'].to_numpy()
for tau in range(1, 10000, 1):
    quad_vec = []
    print('val of tau:', tau)
    for t in range(len(close_list) - 1):
        if(t + tau >= len(es)):
            break
        else:
            delta_p = close_list[t + tau] - close_list[t]
            quad_delta = delta_p * delta_p
            quad_vec.append(quad_delta)
    print('Fin Run')
    var_p = statistics.mean(quad_vec)
    sd_p = math.sqrt(var_p)
    sd_list.append(sd_p)
